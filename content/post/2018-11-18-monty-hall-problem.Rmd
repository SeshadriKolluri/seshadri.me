---
title: "Monty Hall problem: Understanding & Visualization"
author: "Seshadri Kolluri"
date: 2018-11-18
categories: ["Blog"]
tags: ["Visualization", "Probability", "R"]
math: TRUE
---

```{r setup, include=FALSE}
# knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(plyr)
library(ggpubr)
library(knitr)
library(kableExtra)
```

[Monty Hall Problem](https://en.wikipedia.org/wiki/Monty_Hall_problem) is one of the most popular probability puzzles. In this post, we explore the intuition behind the problem. 

### Problem Description:

The problem describes a game show where there are three doors. One of the doors contains a prize behind the door, and the other two doors don't have the prize behind them.  

The rules of the game are as the following.

-   You first choose a door and let the host know. (**Original Choice**, `r knitr::asis_output("\U25FD")`).
-   The host knows which door has the prize, and opens one of the the doors that don't have the prize behind them. This door is then eliminated. (**Eliminated Choice**, `r knitr::asis_output("\U25FE")`).
-   You now have the option of sticking with your Original Choice, or changing to the other remaining door after elimination (**Alternate Choice**, `r knitr::asis_output('<span style="color:#FFE4C4">\U25A6</span>')`).

The question is whether you are better off sticking to your **Original Choice**, or switching to the **Alternate Choice** after elimination as your new choice, or if it **doesn't matter**.

### Solution:

Apparently an overwhelming majority of the people think that it doesn't matter whether you stick to your original choice or change your choice to the remaining door, as both of them are expected to have 33% chance of success originally, or 50% chance of success after you eliminate a door that doesn't contain the prize. But, let us try to arrive at the answer in a more careful way. 

We start with a frequentist approach where we repeat the experiment 30 times, and see how many successes we have with each approach. 

We use `R programming language` to  simulate the experiment 30 times, and we use the plots to understand the results. You can `see the code by clicking on the code button` below. 

```{r data-generation}
set.seed(2017)

# number of runs
n <- 30

# make a dataframe containing three columns called door1, door2, door3. 
# Each row should contain two "goat"s and one "car", randomly distributed among three columns

car_positions <- sample(1:3,n,replace = TRUE)

# run the experiment chosen number of times
df_experiment_runs <- ldply(car_positions, function(x) ifelse(1:3 == x,"car","goat"))
names(df_experiment_runs) <- c("Door1", "Door2", "Door3")
df_experiment_runs$`Run Number` <- as.numeric(row.names(df_experiment_runs))
df_experiment_runs$`First Choice` <- sample(1:3, n, replace = TRUE)
df_experiment_runs$`Prize Location` <- car_positions
df_experiment_runs$`Eliminated Position` <- apply(
    df_experiment_runs, MARGIN = 1, 
    FUN = function(x) setdiff(1:3, c(x['Prize Location'], x['First Choice']))[
        sample(length(setdiff(1:3, c(x['Prize Location'], x['First Choice']))), 1)]
)

df_experiment_runs$`Alternate Choice` <- apply(
    df_experiment_runs, MARGIN = 1, 
    FUN = function(x) setdiff(1:3, c(x['Eliminated Position'], x['First Choice']))[
        sample(length(setdiff(1:3, c(x['Eliminated Position'], x['First Choice']))), 1)]
)

df_experiment_runs_long <- pivot_longer(df_experiment_runs, cols = starts_with("Door"), names_to = "Door")
df_experiment_runs_long$Door <- gsub('Door', '', df_experiment_runs_long$Door)
```

#### 1. Prize locations chosen at random:

First, let us denote the Prize Locations in each of the 30 runs by a **dot (.)**, which is chosen randomly among the 3 doors. 

```{r prize-location}
p0 <- ggplot(df_experiment_runs_long, aes(y = `Run Number`, x = Door)) + 
      geom_tile(fill = 'white', color = 'gray40') + 
      scale_y_continuous(expand = expansion(0,0)) + 
      scale_x_discrete(expand = expansion(0,0)) + 
      coord_equal() +
      theme_bw() + 
      theme(legend.position = 'none', 
            axis.title = element_blank(),
            plot.subtitle = element_text(hjust = 0.5))

p1 <- p0 + geom_point(data = df_experiment_runs, aes(x = `Prize Location`), size = 0.5) + 
        labs(subtitle = 'Prize Locations')

annotate_figure(
  ggarrange(p1, NULL, NULL, NULL, NULL, nrow = 1, align = 'h'),
  left = text_grob("Experiment Number", rot = 90, size = 12),
  bottom = text_grob("Door Choice", size = 12, hjust = 0, x = 0.05)
)

```


#### 2. Original door choice chosen at random:

Then, let us show the original choice of the doors, denoted by gray square (`r knitr::asis_output("\U25FD")`), which are also shown at random. 

```{r original-choice}
p2 <- p0 + geom_tile(data = df_experiment_runs, aes(x = `First Choice`), fill = 'gray80', color = 'gray40')+ 
        labs(subtitle = 'Original Choice')
annotate_figure(
  ggarrange(p1, p2, NULL, NULL, NULL, nrow = 1, align = 'h'),
  left = text_grob("Experiment Number", rot = 90, size = 12),
  bottom = text_grob("Door Choice", size = 12, hjust = 0, x = 0.15)
)

```

#### 3. Original choice combined with prize locations:

When we combine the above two plots, we can see how many times we choose the door containing a prize indicated by a gray square with a dot in the picture below. 

`Number of successes with original choice: number of gray squares with a dot`. 

In the plot below, we can say about 10 out of 30 trials result in a success where the prize location, is same as the original choice, as expected, with about 0.33 probability. 

```{r original-choice-with-prize-location}
p3 <- p2 + geom_point(data = df_experiment_runs, aes(x = `Prize Location`), size = 0.5) + 
        labs(subtitle = 'Original Choice\n+\nPrize Location')

annotate_figure(
  ggarrange(p1, p2, p3, NULL, NULL, nrow = 1, align = 'h'),
  left = text_grob("Experiment Number", rot = 90, size = 12),
  bottom = text_grob("Door Choice", size = 12, hjust = 0, x = 0.25)
)
```

#### 4. Eliminating one of the doors without the prize:

At this point the host would eliminate one of the doors that don't contain the prize. We denote this eliminated choice by black square (`r knitr::asis_output("\U25FE")`).


```{r eliminated-positions}
p4 <- p3 + geom_tile(data = df_experiment_runs, aes(x = `Eliminated Position`), fill = 'gray30', color = 'gray40') + 
        labs(subtitle = 'Original Choice\n+\nEliminated Choice')
annotate_figure(
  ggarrange(p1, p2, p3, p4, NULL, nrow = 1, align = 'h'),
  left = text_grob("Experiment Number", rot = 90, size = 12),
  bottom = text_grob("Door Choice", size = 12, hjust = 0, x = 0.35)
)
```

#### 5. Considering the alternate choice:

After one of the doors, is eliminated we have the option of changing our choice to the alternate door, which is denoted by the orange square (`r knitr::asis_output('<span style="color:#FFE4C4">\U25A6</span>')`) in this picture. 

`Number of successes with alternate choice: number of orange squares with a dot`. 

We can see that there about 20 orange squares with a dot in this experiment of 30 runs, which is about twice the probability of success compared to the original choice. 

```{r alternate-choice}
p5 <- p0 + geom_tile(data = df_experiment_runs, aes(x = `Eliminated Position`), fill = 'gray30', color = 'gray40') + 
          geom_tile(data = df_experiment_runs, aes(x = `Alternate Choice`), fill = 'bisque', color = 'gray40') + 
          geom_point(data = df_experiment_runs, aes(x = `Prize Location`), size = 0.5) + 
          labs(subtitle = 'Alternate Chocie\n+\nPrize Location')

annotate_figure(
  ggarrange(p1, p2, p3, p4, p5, nrow = 1, align = 'h'),
  left = text_grob("Experiment Number", rot = 90, size = 12),
  bottom = text_grob("Door Choice", size = 12, hjust = 0, x = 0.45)
)
```


`So, changing our choice after the elimination of one of the doors, improved the sucess probability by about 2x.`


### Discussion:

The above example showed that we have twice the chance of succeeding by changing our initial choice. 

To understand this further, we can imagine our initial choice as one unit, and the remaining two doors as another unit. The probability of having a prize in our initial choice is 0.33. So, the probability that the prize is one of the remaining two doors is 0.67. 

`When the host eliminates one of the doors that doesn't contain the prize, he is effectively giving us a chance to choose two doors together`: one of the doors that doesn't contain the prize, and the other one which we didn't choose initially. So, the probability of the prize being in that unit of two doors together is 0.67. This is another way to understand this problem. 

